# トークンリフレッシュ

## 1. API概要  

| 項目             | 内容                   | 備考                             |
| ---------------- | ---------------------- | -------------------------------- |
| API名            | トークンリフレッシュ   | -                                |
| エンドポイント   | `/api/v1/auth/refresh` | -                                |
| リソース         | `auth`                 | -                                |
| アクション       | `refresh`              | -                                |
| メソッド         | `POST`                 | -                                |
| ビジネスドメイン | 認証                   | -                                |
| 認証要否         | 不要                   | アクセストークンによる認証は不要 |
| データ形式       | JSON                   | -                                |

## 2. リクエストヘッダ

| 項目名          | 必須 | 値の例             | 備考                 |
| --------------- | ---- | ------------------ | -------------------- |
| `Authorization` | 必須 | `Bearer xxx...`    | リフレッシュトークン |
| `Content-Type`  | 必須 | `application/json` | -                    |

## 3. リクエスト

### ルートオブジェクト(リクエスト)

| 論理名 | 物理名 | 型  | DBテーブル | DBカラム | 必須 | 最小桁数 | 最大桁数 | フォーマット | 最小値 | 最大値 | 備考 |
| ------ | ------ | --- | ---------- | -------- | ---- | -------- | -------- | ------------ | ------ | ------ | ---- |

## 4. 処理概要

リフレッシュトークンを照合して、有効期間内であればアクセストークンを発行し、リフレッシュトークンを更新する。リフレッシュトークンはCookieで返却する。

## 5. レスポンス

- **レスポンスコード** `200 OK`

- **レスポンス**

### ルートオブジェクト(レスポンス)

| 論理名     | 物理名 | 型     | DBテーブル | DBカラム   | 備考 |
| ---------- | ------ | ------ | ---------- | ---------- | ---- |
| トークン   | token  | object | -          | -          | -    |

#### トークン

| 論理名           | 物理名      | 型     | DBテーブル | DBカラム | 備考                |
| ---------------- | ----------- | ------ | ---------- | -------- | ------------------- |
| アクセストークン | accessToken | string | -          | -        | JWTアクセストークン |
| 有効期限         | expiresIn   | number | -          | -        | 有効期限            |

## 6. エラー定義

| HTTPステータスコード      | エラーメッセージ(必須)       | エラーメッセージ詳細(任意)       | 発生条件                                   |
| ------------------------- | ---------------------------- | -------------------------------- | ------------------------------------------ |
| 400 BAD REQUEST           | 入力内容に誤りがあります     | リフレッシュトークンは必須です。 | バリデーションエラー                       |
| 401 UNAUTHORIZED          | 認証情報が無効です           | -                                | 認証に失敗(ユーザー未登録も含む)           |
| 500 INTERNAL SERVER ERROR | システムエラーが発生しました | -                                | 予期せぬサーバー内部エラー(DB接続失敗など) |
